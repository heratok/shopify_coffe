<app-header></app-header>

<div class="cart-page">
  <div class="cart-hero">
    <div class="cart-hero-content">
      <h1 class="cart-title">Your Cart</h1>
      <p class="cart-subtitle">Artisan coffee, carefully selected for you</p>
    </div>
    <div class="cart-hero-pattern"></div>
  </div>

  <ng-container *ngIf="!loading; else loadingTpl">
    <div class="container">
      <ng-container *ngIf="cartItems.length > 0; else emptyCart">
        <div class="cart-content">
          <!-- Cart Items Section -->
          <div class="cart-items-section">
            <div class="section-header">
              <span class="item-count">{{ cartItems.length }} item{{ cartItems.length > 1 ? 's' : '' }}</span>
            </div>
            
            <div class="cart-items-list">
              <div class="cart-item" *ngFor="let item of cartItems; let i = index" [style.animation-delay.ms]="i * 100">
                <div class="item-image-wrapper">
                  <img [src]="item.product.imageUrl" [alt]="item.product.name" class="item-image">
                  <div class="item-image-overlay"></div>
                </div>
                
                <div class="item-details">
                  <div class="item-header">
                    <h3 class="item-name">
                      <a [routerLink]="['/products', item.product.id]">{{ item.product.name }}</a>
                    </h3>
                    <button class="btn-remove" (click)="removeItem(item.product.id)" aria-label="Remove item">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6L18 18"/>
                      </svg>
                    </button>
                  </div>
                  
                  <div class="item-meta">
                    <span class="meta-tag origin">{{ item.product.origin }}</span>
                    <span class="meta-tag roast">{{ item.product.roastLevel }}</span>
                  </div>
                  
                  <div class="item-footer">
                    <div class="quantity-wrapper">
                      <app-quantity-selector
                        [quantity]="item.quantity"
                        (quantityChange)="updateQuantity(item.product.id, $event)">
                      </app-quantity-selector>
                    </div>
                    
                    <div class="item-price">
                      <span class="price-unit">${{ item.product.price | number:'1.2-2' }} each</span>
                      <span class="price-total">${{ item.quantity * item.product.price | number:'1.2-2' }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="cart-actions">
              <a routerLink="/products" class="btn-continue">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Continue Shopping
              </a>
              <button class="btn-clear" (click)="clearCart()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                </svg>
                Clear Cart
              </button>
            </div>
          </div>
          
          <!-- Order Summary -->
          <div class="cart-summary">
            <div class="summary-card">
              <div class="summary-header">
                <h2>Order Summary</h2>
              </div>
              
              <div class="summary-body">
                <div class="summary-row">
                  <span class="row-label">Subtotal</span>
                  <span class="row-value">${{ cartTotal | number:'1.2-2' }}</span>
                </div>
                
                <div class="summary-row shipping-row">
                  <span class="row-label">
                    Shipping
                    <span class="shipping-note" *ngIf="cartTotal <= 50">(Free over $50)</span>
                  </span>
                  <span class="row-value" [class.free-shipping]="cartTotal > 50">
                    {{ cartTotal > 50 ? 'FREE' : '$5.00' }}
                  </span>
                </div>
                
                <div class="summary-divider"></div>
                
                <div class="summary-row total-row">
                  <span class="row-label">Total</span>
                  <span class="row-value total-value">${{ (cartTotal + (cartTotal > 50 ? 0 : 5)) | number:'1.2-2' }}</span>
                </div>
              </div>
              
              <div class="promo-section">
                <div class="promo-toggle" (click)="showPromo = !showPromo">
                  <span>Have a promo code?</span>
                  <svg [class.rotated]="showPromo" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 9l-7 7-7-7"/>
                  </svg>
                </div>
                <div class="promo-form" [class.expanded]="showPromo">
                  <div class="promo-input-group">
                    <input type="text" placeholder="Enter code" class="promo-input">
                    <button class="btn-promo">Apply</button>
                  </div>
                </div>
              </div>
              
              <div class="summary-footer">
                <a routerLink="/checkout" class="btn-checkout">
                  <span>Proceed to Checkout</span>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M5 12h14M12 5l7 7-7 7"/>
                  </svg>
                </a>
                
                <div class="secure-badge">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                  </svg>
                  <span>Secure SSL Encrypted Checkout</span>
                </div>
                
                <div class="payment-methods">
                  <div class="payment-icon">Visa</div>
                  <div class="payment-icon">MC</div>
                  <div class="payment-icon">Amex</div>
                  <div class="payment-icon">PayPal</div>
                </div>
              </div>
            </div>
            
            <!-- Trust Badges -->
            <div class="trust-badges">
              <div class="trust-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M5 13l4 4L19 7"/>
                </svg>
                <span>Freshly Roasted</span>
              </div>
              <div class="trust-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M20 7l-8 10-5-5"/>
                </svg>
                <span>Quality Guaranteed</span>
              </div>
              <div class="trust-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span>Fast Shipping</span>
              </div>
            </div>
          </div>
        </div>
      </ng-container>
      
      <ng-template #emptyCart>
        <div class="empty-cart">
          <div class="empty-cart-content">
            <div class="empty-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
              </svg>
            </div>
            <h2>Your cart is empty</h2>
            <p>Discover our artisan coffee collection and find your perfect brew.</p>
            <a routerLink="/products" class="btn-explore">
              <span>Explore Collection</span>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M5 12h14M12 5l7 7-7 7"/>
              </svg>
            </a>
          </div>
        </div>
      </ng-template>
    </div>
  </ng-container>
  
  <ng-template #loadingTpl>
    <app-cart-skeleton></app-cart-skeleton>
  </ng-template>
</div>

<app-footer></app-footer>
