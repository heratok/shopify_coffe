<app-header></app-header>

<div class="cart-page">
  <ng-container *ngIf="!loading; else loadingTpl">
    <div class="container">
      <h1 class="page-title">Your Shopping Cart</h1>
      
      <ng-container *ngIf="cartItems.length > 0; else emptyCart">
        <div class="cart-content">
          <div class="cart-items">
            <div class="cart-table">
              <div class="cart-header">
                <div class="cart-header-item product-col">Product</div>
                <div class="cart-header-item price-col">Price</div>
                <div class="cart-header-item quantity-col">Quantity</div>
                <div class="cart-header-item total-col">Total</div>
                <div class="cart-header-item action-col"></div>
              </div>
              
              <div class="cart-item" *ngFor="let item of cartItems">
                <div class="product-col">
                  <div class="cart-product">
                    <img [src]="item.product.imageUrl" [alt]="item.product.name">
                    <div class="cart-product-details">
                      <h3>
                        <a [routerLink]="['/products', item.product.id]">{{ item.product.name }}</a>
                      </h3>
                      <div class="product-meta">
                        <span>{{ item.product.origin }}</span>
                        <span>{{ item.product.roastLevel }}</span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="price-col">{{ item.product.price | number:'1.2-2' }}</div>
                <div class="quantity-col">
                  <app-quantity-selector
                    [quantity]="item.quantity"
                    (quantityChange)="updateQuantity(item.product.id, $event)">
                  </app-quantity-selector>
                </div>
                <div class="total-col">{{ item.quantity * item.product.price | number:'1.2-2' }}</div>
                <div class="action-col">
                  <button class="btn-remove" (click)="removeItem(item.product.id)">âœ•</button>
                </div>
              </div>
            </div>
            
            <div class="cart-actions">
              <a routerLink="/products" class="btn btn-secondary">Continue Shopping</a>
              <button class="btn btn-primary" (click)="clearCart()">Clear Cart</button>
            </div>
          </div>
          
          <div class="cart-summary">
            <h2>Order Summary</h2>
            
            <div class="summary-row">
              <span>Subtotal</span>
              <span>{{ cartTotal | number:'1.2-2' }}</span>
            </div>
            
            <div class="summary-row">
              <span>Shipping</span>
              <span>{{ cartTotal > 50 ? 'FREE' : '5.00' }}</span>
            </div>
            
            <div class="summary-row total">
              <span>Total</span>
              <span>{{ (cartTotal + (cartTotal > 50 ? 0 : 5)) | number:'1.2-2' }}</span>
            </div>
            
            <div class="promo-code">
              <h3>Promo Code</h3>
              <div class="promo-form">
                <input type="text" placeholder="Enter code">
                <button class="btn btn-secondary">Apply</button>
              </div>
            </div>
            
            <a routerLink="/checkout" class="btn btn-accent btn-checkout">Proceed to Checkout</a>
            
            <div class="secure-checkout">
              <span>ðŸ”’ Secure Checkout</span>
            </div>
          </div>
        </div>
      </ng-container>
      
      <ng-template #emptyCart>
        <div class="empty-cart">
          <div class="empty-cart-message">
            <h2>Your cart is empty</h2>
            <p>Looks like you haven't added any coffee to your cart yet.</p>
            <a routerLink="/products" class="btn btn-primary">Browse Products</a>
          </div>
        </div>
      </ng-template>
    </div>
  </ng-container>
  
  <ng-template #loadingTpl>
    <app-cart-skeleton></app-cart-skeleton>
  </ng-template>
</div>

<app-footer></app-footer>
