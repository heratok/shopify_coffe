<app-header></app-header>

<div class="product-detail-page">
  <ng-container *ngIf="!loading; else loadingTpl">
    <div class="container" *ngIf="product">
      <!-- Breadcrumbs -->
      <div class="breadcrumbs">
        <a routerLink="/">Home</a> /
        <a routerLink="/products">Products</a> /
        <span>{{ product.name }}</span>
      </div>
      
      <!-- Product Detail -->
      <div class="product-detail">
        <div class="product-images">
          <div class="main-image">
            <img [src]="product.imageUrl" [alt]="product.name">
          </div>
        </div>
        
        <div class="product-info">
          <h1 class="product-title">{{ product.name }}</h1>
          
          <div class="product-meta">
            <div class="product-origin">Origin: <span>{{ product.origin }}</span></div>
            <div class="product-roast">Roast Level: <span>{{ product.roastLevel }}</span></div>
          </div>
          
          <div class="product-rating">
            <div class="stars">
              <span *ngFor="let star of [1,2,3,4,5]" [class.filled]="star <= product.rating">â˜…</span>
            </div>
            <span class="rating-count">{{ product.reviewCount }} reviews</span>
          </div>
          
          <div class="product-price">${{ product.price | number:'1.2-2' }}</div>
          
          <div class="product-description">
            <p>{{ product.description }}</p>
          </div>
          
          <div class="flavor-notes">
            <h3>Flavor Notes</h3>
            <div class="tags">
              <span class="tag" *ngFor="let note of product.flavourNotes">{{ note }}</span>
            </div>
          </div>
          
          <div class="product-actions">
            <div class="quantity">
              <span class="label">Quantity:</span>
              <app-quantity-selector 
                [quantity]="quantity" 
                (quantityChange)="updateQuantity($event)">
              </app-quantity-selector>
            </div>
            
            <button 
              class="btn btn-primary btn-lg"
              (click)="addToCart()"
              [disabled]="!product.inStock">
              {{ product.inStock ? 'Add to Cart' : 'Out of Stock' }}
            </button>
          </div>
          
          <div class="shipping-info">
            <p>ðŸšš Free shipping on orders over $50</p>
            <p>ðŸ”„ 30-day money-back guarantee</p>
            <p>â˜• Freshly roasted to order</p>
          </div>
        </div>
      </div>
      
      <!-- Product Details Tabs -->
      <div class="product-tabs">
        <div class="tabs-header">
          <button 
            class="tab-btn" 
            [class.active]="activeTab === 'details'"
            (click)="setActiveTab('details')">
            Details
          </button>
          <button 
            class="tab-btn" 
            [class.active]="activeTab === 'brewing'"
            (click)="setActiveTab('brewing')">
            Brewing Guide
          </button>
          <button 
            class="tab-btn" 
            [class.active]="activeTab === 'reviews'"
            (click)="setActiveTab('reviews')">
            Reviews ({{ product.reviewCount }})
          </button>
        </div>
        
        <div class="tab-content">
          <div *ngIf="activeTab === 'details'" class="tab-pane">
            <h3>Product Details</h3>
            <table class="details-table">
              <tr>
                <td>Origin</td>
                <td>{{ product.origin }}</td>
              </tr>
              <tr>
                <td>Roast Level</td>
                <td>{{ product.roastLevel }}</td>
              </tr>
              <tr>
                <td>Weight</td>
                <td>{{ product.weight }}g</td>
              </tr>
              <tr>
                <td>Flavor Notes</td>
                <td>{{ product.flavourNotes.join(', ') }}</td>
              </tr>
              <tr>
                <td>Category</td>
                <td>{{ product.category }}</td>
              </tr>
            </table>
          </div>
          
          <div *ngIf="activeTab === 'brewing'" class="tab-pane">
            <h3>Brewing Guide</h3>
            <div class="brewing-methods">
              <div class="brewing-method">
                <h4>French Press</h4>
                <p>Coarse grind. 1:15 coffee to water ratio. 4-minute steep time.</p>
              </div>
              <div class="brewing-method">
                <h4>Pour Over</h4>
                <p>Medium grind. 1:17 coffee to water ratio. 3-minute brew time.</p>
              </div>
              <div class="brewing-method">
                <h4>Espresso</h4>
                <p>Fine grind. 1:2 coffee to water ratio. 25-30 second extraction.</p>
              </div>
            </div>
          </div>
          
          <div *ngIf="activeTab === 'reviews'" class="tab-pane">
            <h3>Customer Reviews</h3>
            <div class="reviews-summary">
              <div class="average-rating">
                <div class="rating-number">{{ product.rating.toFixed(1) }}</div>
                <div class="stars">
                  <span *ngFor="let star of [1,2,3,4,5]" [class.filled]="star <= product.rating">â˜…</span>
                </div>
                <div class="rating-count">Based on {{ product.reviewCount }} reviews</div>
              </div>
            </div>
            
            <div class="reviews-list">
              <div class="review">
                <div class="review-header">
                  <div class="reviewer">John D.</div>
                  <div class="review-date">2 months ago</div>
                </div>
                <div class="review-rating">
                  <span *ngFor="let star of [1,2,3,4,5]" [class.filled]="star <= 5">â˜…</span>
                </div>
                <div class="review-content">
                  <p>This coffee is amazing! Rich flavor with notes of chocolate and berries as described. Will definitely purchase again.</p>
                </div>
              </div>
              
              <div class="review">
                <div class="review-header">
                  <div class="reviewer">Sarah M.</div>
                  <div class="review-date">1 month ago</div>
                </div>
                <div class="review-rating">
                  <span *ngFor="let star of [1,2,3,4,5]" [class.filled]="star <= 4">â˜…</span>
                </div>
                <div class="review-content">
                  <p>Great coffee with a smooth finish. Works well as both espresso and pour over. The aroma is wonderful!</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
  
  <ng-template #loadingTpl>
    <app-product-detail-skeleton></app-product-detail-skeleton>
  </ng-template>
</div>

<app-footer></app-footer>
